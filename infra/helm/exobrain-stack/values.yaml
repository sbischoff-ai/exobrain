global:
  imagePullSecrets: []
  storageClass: ""

assistantFrontend:
  replicaCount: 1
  env:
    PUBLIC_LOG_LEVEL: warn
  image:
    repository: exobrain/assistant-frontend
    tag: "0.1.0"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 3000
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

assistantBackend:
  replicaCount: 1
  image:
    repository: exobrain/assistant-backend
    tag: "0.1.0"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8000
  env:
    APP_ENV: cluster
    LOG_LEVEL: INFO
    KNOWLEDGE_INTERFACE_ADDR: exobrain-knowledge-interface:50051
    METASTORE_DSN: postgresql://exobrain:exobrain@exobrain-metastore:5432/exobrain
    ASSISTANT_DB_DSN: postgresql://assistant_backend:assistant_backend@exobrain-metastore:5432/assistant_db
    ASSISTANT_CACHE_REDIS_URL: redis://exobrain-assistant-cache:6379/0
    EXOBRAIN_NATS_URL: nats://exobrain-message-broker:4222
    JOBS_SUBJECT_PREFIX: jobs
  secrets:
    openaiApiKey:
      name: exobrain-secrets
      key: OPENAI_API_KEY
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1
      memory: 1Gi

knowledgeInterface:
  replicaCount: 1
  image:
    repository: exobrain/knowledge-interface
    tag: "0.1.0"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 50051
  env:
    APP_ENV: cluster
    LOG_LEVEL: INFO
    MEMGRAPH_BOLT_ADDR: bolt://exobrain-knowledge-graph:7687
    QDRANT_ADDR: http://exobrain-vector-store:6333
    METASTORE_DSN: postgresql://exobrain:exobrain@exobrain-metastore:5432/exobrain
    KNOWLEDGE_SCHEMA_DSN: postgresql://knowledge_schema:knowledge_schema@exobrain-metastore:5432/knowledge_graph_schema
    ASSISTANT_DB_DSN: postgresql://assistant_backend:assistant_backend@exobrain-metastore:5432/assistant_db
    OPENAI_EMBEDDING_MODEL: text-embedding-3-small
  secrets:
    openaiApiKey:
      name: exobrain-secrets
      key: OPENAI_API_KEY
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

metastore:
  replicaCount: 1
  image:
    repository: postgres
    tag: "16"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 5432
  auth:
    username: exobrain
    password: exobrain
    database: exobrain
  assistantDb:
    username: assistant_backend
    password: assistant_backend
    database: assistant_db
  jobOrchestratorDb:
    username: job_orchestrator
    password: job_orchestrator
    database: job_orchestrator_db
  knowledgeSchemaDb:
    username: knowledge_schema
    password: knowledge_schema
    database: knowledge_graph_schema
  persistence:
    enabled: true
    size: 10Gi
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1
      memory: 1Gi

memgraph:
  fullnameOverride: exobrain-knowledge-graph
  sysctlInitContainer:
    enabled: true
  persistentVolumeClaim:
    createStorageClaim: true
    storageSize: 10Gi
    createLogStorage: false
  service:
    type: ClusterIP
    enableBolt: true

vectorStore:
  replicaCount: 1
  image:
    repository: qdrant/qdrant
    tag: "v1.9.2"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    httpPort: 6333
    grpcPort: 6334
  persistence:
    enabled: true
    size: 10Gi
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 2
      memory: 2Gi

assistantCache:
  replicaCount: 1
  image:
    repository: redis
    tag: "7-alpine"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 6379
  persistence:
    enabled: true
    size: 2Gi
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 500m
      memory: 256Mi

messageBroker:
  replicaCount: 1
  image:
    repository: nats
    tag: "2.10.14-alpine"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    clientPort: 4222
    monitoringPort: 8222
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 500m
      memory: 256Mi


jobOrchestrator:
  image:
    repository: exobrain/job-orchestrator
    tag: "0.1.0"
    pullPolicy: IfNotPresent
  env:
    JOB_ORCHESTRATOR_DB_DSN: postgresql://job_orchestrator:job_orchestrator@exobrain-metastore:5432/job_orchestrator_db
    EXOBRAIN_NATS_URL: nats://exobrain-message-broker:4222
    JOB_QUEUE_SUBJECT: jobs.>
    JOB_EVENTS_SUBJECT_PREFIX: jobs.events
  worker:
    replicaCount: 1
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 1
        memory: 512Mi

ingress:
  enabled: true
  className: traefik
  annotations: {}
  hosts:
    - host: localhost
      paths:
        - path: /api
          pathType: Prefix
          backend:
            service:
              name: exobrain-assistant-backend
              port: 8000
        - path: /
          pathType: Prefix
          backend:
            service:
              name: exobrain-assistant-frontend
              port: 3000
  tls: []



dbJobs:
  image:
    repository: exobrain/assistant-db-tools
    tag: "0.1.0"
    pullPolicy: IfNotPresent

  assistantBackendMigrations:
    enabled: true
    backoffLimit: 4
    ttlSecondsAfterFinished: 600
    env:
      POSTGRES_DSN: postgresql://exobrain:exobrain@exobrain-metastore:5432/postgres
      ASSISTANT_DB_DSN: postgresql://assistant_backend:assistant_backend@exobrain-metastore:5432/assistant_db
      MIGRATIONS_DIR: /opt/exobrain/assistant-backend/migrations
      BOOTSTRAP_SQL_PATH: /opt/exobrain/sql/init/01-assistant-db.sql
      WAIT_TIMEOUT_SECONDS: "180"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi

  jobOrchestratorMigrations:
    enabled: true
    backoffLimit: 4
    ttlSecondsAfterFinished: 600
    env:
      POSTGRES_DSN: postgresql://exobrain:exobrain@exobrain-metastore:5432/postgres
      JOB_ORCHESTRATOR_DB_DSN: postgresql://job_orchestrator:job_orchestrator@exobrain-metastore:5432/job_orchestrator_db
      MIGRATIONS_DIR: /opt/exobrain/job-orchestrator/migrations
      BOOTSTRAP_SQL_PATH: /opt/exobrain/sql/init/02-job-orchestrator-db.sql
      WAIT_TIMEOUT_SECONDS: "180"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi

  assistantBackendSeed:
    enabled: false
    backoffLimit: 2
    ttlSecondsAfterFinished: 600
    env:
      ASSISTANT_DB_DSN: postgresql://assistant_backend:assistant_backend@exobrain-metastore:5432/assistant_db
      SEED_SQL_DIR: /opt/exobrain/assistant-backend/seeds
      WAIT_TIMEOUT_SECONDS: "180"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi


  knowledgeSchemaMigrations:
    enabled: true
    backoffLimit: 4
    ttlSecondsAfterFinished: 600
    env:
      POSTGRES_DSN: postgresql://exobrain:exobrain@exobrain-metastore:5432/postgres
      KNOWLEDGE_SCHEMA_DSN: postgresql://knowledge_schema:knowledge_schema@exobrain-metastore:5432/knowledge_graph_schema
      MIGRATIONS_DIR: /opt/exobrain/knowledge-interface/migrations
      BOOTSTRAP_SQL_PATH: /opt/exobrain/sql/init/03-knowledge-schema-db.sql
      WAIT_TIMEOUT_SECONDS: "180"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi

  knowledgeSchemaSeed:
    enabled: false
    backoffLimit: 2
    ttlSecondsAfterFinished: 600
    env:
      KNOWLEDGE_SCHEMA_DSN: postgresql://knowledge_schema:knowledge_schema@exobrain-metastore:5432/knowledge_graph_schema
      SEED_SQL_DIR: /opt/exobrain/knowledge-interface/seeds
      WAIT_TIMEOUT_SECONDS: "180"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi
